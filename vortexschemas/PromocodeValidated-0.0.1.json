{
  "description": "Sent every time a promocode is validated from the ECommerce PromocodeService",
  "definitions": {
    "DiscountItem": {
      "type": "object",
      "properties": {
        "invoiceId": {
          "description": "Id of an invoice discount is assign to",
          "type": "string"
        },
        "currencyCode": {
          "description": "Currency code in with discount is applied",
          "type": "string"
        },
        "productId": {
          "description": "Id of a product that this discount is assign to",
          "type": "string"
        },
        "productUri": {
          "description": "Uri of a product that this discount is assign to",
          "type": "string",
          "format": "uri"
        },
        "vendor": {
          "description": "Vendor of linked product",
          "type": "string"
        },
        "amount": {
          "description": "Discount amount. Should be negative to reflect it's a discount",
          "type": "number"
        }
      },
      "required": [
        "invoiceId",
        "currencyCode",
        "productId",
        "productUri",
        "vendor",
        "amount"
      ],
      "additionalProperties": false
    },
    "HeaderContext": {
      "type": "object",
      "properties": {
        "producerReference": {
          "description": "Unique tracking id generated by producer that may be used to trace the message inside Vortex. e.g. the id in the producer database.",
          "type": "string"
        },
        "eventTime": {
          "description": "Date & time (millisecond accurate) of event that triggered the publishing of this message, ISO 8601 with offset e.g. 2002-09-24T16:35:56.123Z",
          "type": "string",
          "format": "date-time"
        },
        "eventName": {
          "description": "Name of event that triggered the publish of the message. Camel case, past-tense e.g. ticketBooked",
          "type": "string"
        },
        "appRegisterId": {
          "description": "Identifier of application producing the message",
          "type": "integer"
        },
        "serviceName": {
          "description": "Producing service name e.g. RetailProtocolService.",
          "type": "string"
        },
        "serviceVersion": {
          "description": "Producing service version in SemVer format.",
          "type": "string"
        },
        "origin": {
          "description": "Some indication of message origin, eg. server hostname, VPC, etc.",
          "type": "string"
        },
        "environmentName": {
          "description": "Environment that producer is running in e.g. prod.",
          "type": "string"
        },
        "conversationId": {
          "description": "Unique Id that tracks the sequence of message calls that led to the triggering event.",
          "type": "string"
        },
        "contextUri": {
          "description": "Uri of the context attached to the resource for the event.",
          "type": "string",
          "format": "uri"
        },
        "managedGroupId": {
          "description": "Corporate Reference ID.",
          "type": "string"
        },
        "entryPointId": {
          "description": "ID of the entrypoint, eg. 111 for Trainline Leisure Desktop Web.",
          "type": "string"
        },
        "managedGroupTenantId": {
          "description": "Corporate Reference ID.",
          "type": "string"
        },
        "affiliateId": {
          "description": "Affiliate code identifier. eg. PAYPAL, MTT, etc.",
          "type": "string"
        }
      },
      "required": [
        "eventTime",
        "eventName",
        "serviceName",
        "serviceVersion",
        "origin",
        "environmentName",
        "contextUri",
        "managedGroupId",
        "entryPointId"
      ],
      "additionalProperties": false
    }
  },
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "code": {
      "description": "Code",
      "type": "string"
    },
    "discountItems": {
      "description": "Discounts generated as part of the validation.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/DiscountItem"
      }
    },
    "header": {
      "$ref": "#/definitions/HeaderContext"
    }
  },
  "required": [
    "code",
    "discountItems",
    "header"
  ]
}